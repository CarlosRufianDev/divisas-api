// ==============================
// TOKENS DE USUARIO Y ADMIN
// ==============================
// Copia aqu√≠ los tokens tras hacer login para pruebas autenticadas
@adminToken = PON_AQUI_EL_TOKEN_DEL_ADMIN
@userToken = PON_AQUI_EL_TOKEN_DEL_USUARIO_PRUEBA
@realToken = PON_AQUI_EL_TOKEN_DEL_USUARIO_REAL

############################################################
### üü¢ AUTENTICACI√ìN Y USUARIOS
############################################################

### Registro de administrador (solo una vez)
POST http://localhost:3000/api/auth/register
Content-Type: application/json

{
  "email": "admin@email.com",
  "password": "Administrador123",
  "role": "admin",
  "name": "Admin Test"
}

### Login de administrador
POST http://localhost:3000/api/auth/login
Content-Type: application/json

{
  "email": "admin@email.com",
  "password": "Administrador123"
}

### Registro de usuario de pruebas
POST http://localhost:3000/api/auth/register
Content-Type: application/json

{
  "email": "pruebausuario@email.com",
  "password": "Pruebausuario123",
  "name": "Usuario Prueba"
}

### Login de usuario de pruebas
POST http://localhost:3000/api/auth/login
Content-Type: application/json

{
  "email": "pruebausuario@email.com",
  "password": "Pruebausuario123"
}

### Registro de usuario real (para email)
POST http://localhost:3000/api/auth/register
Content-Type: application/json

{
  "email": "‚ñàREDACTED_EMAIL‚ñà",
  "password": "TuPasswordSegura123",
  "name": "Carlos Rufi√°n"
}

### Login de usuario real
POST http://localhost:3000/api/auth/login
Content-Type: application/json

{
  "email": "‚ñàREDACTED_EMAIL‚ñà",
  "password": "TuPasswordSegura123"
}

### Borrar usuario de pruebas (solo admin)
DELETE http://localhost:3000/api/auth/delete
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "email": "pruebausuario@email.com"
}

### Borrar mi propia cuenta (usuario autenticado)
DELETE http://localhost:3000/api/auth/me
Authorization: Bearer {{userToken}}

############################################################
### üí± CONVERSI√ìN DE MONEDAS
############################################################

### Conversi√≥n v√°lida (usuario real)
POST http://localhost:3000/api/convert
Content-Type: application/json
Authorization: Bearer {{realToken}}

{
  "from": "USD",
  "to": "EUR",
  "amount": 3555
}

### ‚ùå amount negativo (debe dar 400)
POST http://localhost:3000/api/convert
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "from": "USD",
  "to": "EUR",
  "amount": -50
}

### ‚ùå c√≥digo de moneda inv√°lido (debe dar 400)
POST http://localhost:3000/api/convert
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "from": "US",
  "to": "EUR",
  "amount": 100
}

### ‚ùå tipo de dato incorrecto (debe dar 400)
POST http://localhost:3000/api/convert
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "from": "USD",
  "to": "EUR",
  "amount": "cien"
}

############################################################
### üìú HISTORIAL Y FILTROS
############################################################

### Historial del usuario autenticado (todos)
GET http://localhost:3000/api/historial
Authorization: Bearer {{userToken}}

### Solo USD ‚Üí EUR
GET http://localhost:3000/api/historial?from=USD&to=EUR
Authorization: Bearer {{userToken}}

### Conversiones de al menos 50
GET http://localhost:3000/api/historial?minAmount=50
Authorization: Bearer {{userToken}}

### Conversiones de m√°ximo 100
GET http://localhost:3000/api/historial?maxAmount=100
Authorization: Bearer {{userToken}}

### Entre fechas
GET http://localhost:3000/api/historial?startDate=2025-07-01&endDate=2025-07-04
Authorization: Bearer {{userToken}}

### Historial paginado (primera p√°gina, 5 resultados)
GET http://localhost:3000/api/historial?page=1&limit=5
Authorization: Bearer {{userToken}}

############################################################
### üóëÔ∏è BORRADO DE HISTORIAL
############################################################

### Borrar todo el historial (usuario autenticado)
DELETE http://localhost:3000/api/historial
Authorization: Bearer {{userToken}}

### Borrar una conversi√≥n por ID (ajusta el ID real)
DELETE http://localhost:3000/api/historial/<ID>
Authorization: Bearer {{userToken}}

### Eliminar historial de un usuario (solo admin)
DELETE http://localhost:3000/api/historial/user/<ID_DEL_USUARIO>
Authorization: Bearer {{adminToken}}

### Limpieza de historial antiguo (solo admin)
GET http://localhost:3000/api/clean-old
Authorization: Bearer {{adminToken}}

############################################################
### üîî ALERTAS DE VARIACI√ìN
############################################################

### Crear alerta (usuario real, para recibir email)
POST http://localhost:3000/api/alerts
Content-Type: application/json
Authorization: Bearer {{realToken}}

{
  "from": "EUR",
  "to": "USD",
  "intervalDays": 1
}

### Crear alerta (usuario de pruebas)
POST http://localhost:3000/api/alerts
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "from": "USD",
  "to": "EUR",
  "intervalDays": 2
}

### Obtener alertas (usuario autenticado)
GET http://localhost:3000/api/alerts
Authorization: Bearer {{userToken}}

### ‚ùå Crear alerta con datos inv√°lidos (debe dar 400)
POST http://localhost:3000/api/alerts
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "from": "INVALID",
  "to": "USD",
  "intervalDays": "uno"
}

### ‚ùå Crear alerta con moneda de destino igual a la de origen (debe dar 400)
POST http://localhost:3000/api/alerts
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "from": "USD",
  "to": "USD",
  "intervalDays": 1
}

############################################################
### üö´ TESTS DE ERRORES Y ACCESO NO AUTORIZADO
############################################################

### ‚ùå Registro con email ya existente (debe dar 409)
POST http://localhost:3000/api/auth/register
Content-Type: application/json

{
  "email": "pruebausuario@email.com",
  "password": "Pruebausuario123",
  "name": "Usuario Prueba"
}

### ‚ùå Registro con email inv√°lido (debe dar 400)
POST http://localhost:3000/api/auth/register
Content-Type: application/json

{
  "email": "noesunemail",
  "password": "123"
}

### ‚ùå Login con contrase√±a incorrecta (debe dar 401)
POST http://localhost:3000/api/auth/login
Content-Type: application/json

{
  "email": "pruebausuario@email.com",
  "password": "contrase√±a_incorrecta"
}

### ‚ùå Acceso a historial sin token (debe dar 401)
GET http://localhost:3000/api/historial

### ‚ùå Borrar historial sin token (debe dar 401)
DELETE http://localhost:3000/api/historial

### ‚ùå Acceso a alertas sin token (debe dar 401)
GET http://localhost:3000/api/alerts

### ‚ùå Borrar alerta sin token (debe dar 401)
DELETE http://localhost:3000/api/alerts




